% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morpho_calibrate.R
\name{npoly_calibrate_r2}
\alias{npoly_calibrate_r2}
\title{Calibrate polynomial degree using R2}
\usage{
npoly_calibrate_r2(
  x,
  degree_range = 2:12,
  id = NULL,
  thresh = c(0.9, 0.95, 0.99),
  .cols = NULL
)
}
\arguments{
\item{x}{A tibble with coo columns containing open curves.}

\item{degree_range}{Integer vector. Range of degrees to test. Default is 2:12.}

\item{id}{Integer vector or NULL. Which shapes to use for calibration.
If NULL, uses all shapes (or samples if many). If integer vector, uses
those specific row indices.}

\item{thresh}{Numeric vector. R2 thresholds for recommendations.
Default is c(0.90, 0.95, 0.99).}

\item{.cols}{Column name(s) to process. If NULL, uses first coo column.
Supports tidyeval (e.g., \code{.cols = VD}).}
}
\value{
A list with class \code{c("calibrate_r2", "calibrate")} containing:
\itemize{
\item \code{data}: Tibble with columns shape, degree, and r2
\item \code{recommended}: Named integer vector of minimum degree per threshold
\item \code{summary}: Character string with human-readable recommendation
}

The list has attributes:
\itemize{
\item \code{method}: "npoly"
\item \code{metric}: "r2"
\item \code{param_name}: "degree"
\item \code{thresh}: the threshold values used
}
}
\description{
Calculate R2 (goodness of fit) across a range of polynomial degrees to
determine optimal degree for natural polynomial fitting.
}
\details{
This function fits natural polynomials at each degree in \code{degree_range}
for the specified shapes and calculates R2 (proportion of variance explained).
Higher degrees always produce higher R2 but may overfit. The goal is to find
the minimum degree that achieves acceptable R2.
\subsection{Choosing thresholds}{

Common interpretations:
\itemize{
\item 0.90 (90\%): Rough approximation, may miss details
\item 0.95 (95\%): Good balance for most applications
\item 0.99 (99\%): High fidelity, captures fine details
}
}

\subsection{Sampling strategy}{

When \code{id = NULL}:
\itemize{
\item If <= 30 shapes: uses all
\item If > 30 shapes: randomly samples 30 (set seed for reproducibility)
}
}

\subsection{Plotting}{

Use \code{plot(cal)} to visualize results as a boxplot with threshold lines.
}
}
\examples{
# Calibrate on subset of olea
data(olea)
cal <- olea[1:10, ] \%>\%
  npoly_calibrate_r2(.cols=VD)

# Examine results
cal$recommended
cal$summary
plot(cal)

# Use recommended degree
olea \%>\% npoly(degree = cal$recommended["0.99"])

# Tidyeval column selection
olea[1:10, ] \%>\%
  npoly_calibrate_r2(.cols = VD)

}
\seealso{
\code{\link[=npoly_calibrate_reconstruction]{npoly_calibrate_reconstruction()}}, \code{\link[=npoly]{npoly()}}
}
