% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morpho_eft.R
\name{eft_norm}
\alias{eft_norm}
\title{Normalize elliptic Fourier coefficients}
\usage{
eft_norm(x, start = FALSE, ..., .cols = NULL, .name = NULL)
}
\arguments{
\item{x}{A numeric vector (EFT coefficients), list of vectors, or tibble
with coe columns.}

\item{start}{Logical. If \code{TRUE}, preserves the starting point position.
Default is \code{FALSE} (removes starting point effect).}

\item{...}{Additional arguments (reserved for future use).}

\item{.cols}{Column name(s) to process when \code{x} is a tibble. If \code{NULL},
automatically detects columns containing coe objects.}

\item{.name}{Character. Name for the output coefficient column when \code{x} is
a tibble. If \code{NULL}, modifies the column in place. If provided, creates
a new column with this name.}
}
\value{
\itemize{
\item If \code{x} is a vector: returns a normalized coefficient vector with class \code{c("eft", "numeric")}
\item If \code{x} is a list: returns a list of normalized coefficient vectors
\item If \code{x} is a tibble: returns the tibble with normalized coefficients
(either modifying in place or creating a new column)
}
}
\description{
Normalize EFT coefficients to remove the effects of size, rotation, and
starting position, making shapes directly comparable.
}
\details{
Normalization removes three sources of variation that are typically not of
interest in shape analysis:
\enumerate{
\item \strong{Size}: Coefficients are scaled so the first ellipse has unit semi-axis length
\item \strong{Rotation}: Coefficients are rotated so the first ellipse aligns with the x-axis
\item \strong{Starting point} (if \code{start = FALSE}): The phase of all harmonics is
adjusted to remove the effect of where digitization began
}

After normalization, shapes can be directly compared using multivariate statistics,
as remaining variation represents only shape differences.

The first harmonic (A1, B1, C1, D1) is used to compute the normalization
parameters. For \code{start = FALSE}, these parameters are:
\itemize{
\item \code{theta}: Phase shift to remove starting point effect
\item \code{psi}: Rotation angle to align with x-axis
\item \code{size}: Scaling factor (inverse of first ellipse semi-axis length)
}

These normalization parameters are stored as attributes on the result for
reference but are typically not needed for downstream analysis.
}
\section{When to use normalization}{

\itemize{
\item \strong{Always normalize} before multivariate analysis (PCA, LDA, etc.) if you want
to compare shapes independent of size, rotation, and starting point
\item \strong{Skip normalization} if size or orientation are biologically meaningful
\item Use \code{start = TRUE} if the starting point has biological meaning (e.g.,
a specific landmark)
}
}

\examples{
# Single outline
coo <- matrix(runif(100), ncol = 2)
coefs <- eft(coo, nb_h = 6)

# Normalize
coefs_norm <- eft_norm(coefs)

# Preserve starting point
coefs_norm_start <- eft_norm(coefs, start = TRUE)

# Compare first harmonic before/after
coefs[1:4]
coefs_norm[1:4]

\dontrun{
# Typical workflow with tibble
library(dplyr)
bot \%>\%
  eft(nb_h = 8) \%>\%
  eft_norm()  # Normalizes in place

# Create new column instead
bot \%>\%
  eft(nb_h = 8) \%>\%
  eft_norm(.name = "coe_norm")
}

}
\references{
Kuhl, F. P., & Giardina, C. R. (1982). Elliptic Fourier features of a closed
contour. Computer graphics and image processing, 18(3), 236-258.
}
\seealso{
\code{\link[=eft]{eft()}} for coefficient computation, \code{\link[=eft_i]{eft_i()}} for
reconstruction.
}
