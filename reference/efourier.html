<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Elliptical Fourier transforms — efourier • Momocs2</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Elliptical Fourier transforms — efourier" />
<meta property="og:description" content="Elliptical Fourier transforms" />
<meta property="og:image" content="http://momx.github.io/Momocs2/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Momocs2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/architecture.html">Architecture</a>
    </li>
    <li>
      <a href="../articles/extending.html">Extending</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics</a>
    </li>
    <li>
      <a href="../articles/intro.html">Philosophy</a>
    </li>
    <li>
      <a href="../articles/shape.html">Shape manipulation</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MomX/Momocs2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Elliptical Fourier transforms</h1>
    
    <div class="hidden name"><code>efourier.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Elliptical Fourier transforms</p>
    </div>

    <pre class="usage"><span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='kw'>nb_h</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for coo_single</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='kw'>nb_h</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for coo_list</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='kw'>nb_h</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>...</span>)

<span class='co'># S3 method for mom_tbl</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='kw'>nb_h</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>keep_coo</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>efourier_i</span>(<span class='no'>x</span>, <span class='kw'>nb_h</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>nb_pts</span> <span class='kw'>=</span> <span class='fl'>120</span>)

<span class='fu'>efourier_norm</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>efourier_norm</span>(<span class='no'>x</span>, <span class='kw'>first_point</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for coe_list</span>
<span class='fu'>efourier_norm</span>(<span class='no'>x</span>, <span class='kw'>first_point</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for mom_tbl</span>
<span class='fu'>efourier_norm</span>(<span class='no'>x</span>, <span class='kw'>first_point</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>coo_single, coo_list or mom_tbl</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for generics. Useless here.</p></td>
    </tr>
    <tr>
      <th>nb_h</th>
      <td><p><code>int</code> nb of harmonics. Default to <code>6</code> for <code>efourier</code>, to all of them for <code>efourier_i</code></p></td>
    </tr>
    <tr>
      <th>raw</th>
      <td><p><code>logical</code> whether to return raw and full results for efourier and efourier_norm</p></td>
    </tr>
    <tr>
      <th>keep_coo</th>
      <td><p><code>logical</code> whether to retain coo column</p></td>
    </tr>
    <tr>
      <th>nb_pts</th>
      <td><p><code>int</code> nb of points for the reconstruction</p></td>
    </tr>
    <tr>
      <th>first_point</th>
      <td><p><code>logical</code> whether to normalize for the first point using efourier_norm</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the maths behind see the paper in JSS.</p>
<p>Normalization of coefficients has long been a matter of trouble,
and not only for newcomers. There are two ways of normalizing outlines: the first,
and by far the most used, is to use a "numerical" alignment, directly on the
matrix of coefficients. The coefficients of the first harmonic are consumed
by this process but harmonics of higher rank are normalized in terms of size
and rotation. This is sometimes referred as using the "first ellipse", as the
harmonics define an ellipse in the plane, and the first one is the mother of all
ellipses, on which all others "roll" along. This approach is really convenient
as it is done easily by most software (if not the only option) and by Momocs too.
It is the default option of efourier.</p>
<p>But here is the pitfall: if your shapes are prone to bad aligments among all
the first ellipses, this will result in poorly (or even not at all) "homologous" coefficients.
The shapes particularly prone to this are either (at least roughly) circular and/or with a strong
bilateral symmetry. Also, and perhaps more explicitely, morphospace usually show a mirroring symmetry,
typically visible when calculated in some couple of components (usually the first two).</p>
<p>If you see these  upside-down (or 180 degrees rotated) shapes on the morphospace,
you should seriously consider aligning your shapes <strong>before</strong> the efourier step,
and performing the latter with <code>norm = FALSE</code>.</p>
<p>You have several options to align your shapes, using control points (or landmarks),
by far the most time consuming (and less reproducible) but possibly the best one too
when alignment is too tricky to automate.
You can also try Procrustes alignment (see fgProcrustes) (&lt;- todo link 4 here) through their calliper
length (see coo_aligncalliper), etc. You should also make the first
point homologous either with coo_slide or coo_slidedirection
to minimize any subsequent problems.</p>
<p>I will dedicate (some day) a vignette or a paper to this problem.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>efourier_i</code>: inverse efourier function</p></li>
<li><p><code>efourier_norm</code>: efourier numerical normalization</p></li>
</ul>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Claude, J. (2008) <strong>Morphometrics with R</strong>, Use R! series,
Springer 316 pp.
Ferson S, Rohlf FJ, Koehn RK. 1985. Measuring shape variation of
two-dimensional outlines. <strong>Systematic Biology</strong> <strong>34</strong>: 59-68.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other morphometrics: 
<code>dfourier()</code>,
<code>npoly()</code>,
<code>opoly()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>bot</span> <span class='kw'>%&gt;%</span> <span class='fu'>pick</span>() <span class='kw'>%&gt;%</span> <span class='fu'>efourier</span>(<span class='fl'>4</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'>efourier_i</span>()</div><div class='output co'>#&gt; # A tibble: 1 x 16
#&gt;      a1    a2    a3     a4    b1    b2    b3    b4    c1    c2    c3    c4    d1
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 -125.  4.35  21.6 -0.938 -16.1 -29.8  5.56  4.68  33.8 -3.24 -9.33  4.84 -438.
#&gt; # … with 3 more variables: d2 &lt;dbl&gt;, d3 &lt;dbl&gt;, d4 &lt;dbl&gt;
#&gt; ❯coe_single with 16 coefficients</div><div class='output co'>#&gt; # A tibble: 120 x 2
#&gt;        x     y
#&gt;    &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1     0     0
#&gt;  2     0     0
#&gt;  3     0     0
#&gt;  4     0     0
#&gt;  5     0     0
#&gt;  6     0     0
#&gt;  7     0     0
#&gt;  8     0     0
#&gt;  9     0     0
#&gt; 10     0     0
#&gt; # … with 110 more rows
#&gt; ❯coo_single with 120 coordinates</div><div class='input'><span class='no'>bot</span>$<span class='no'>coo</span>[<span class='fl'>1</span>:<span class='fl'>2</span>] <span class='kw'>%&gt;%</span> <span class='fu'>efourier</span>(<span class='fl'>4</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'>efourier_i</span>() <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>()</div><div class='output co'>#&gt; &lt;list_of&lt;coe_single&lt;&gt;&gt;[2]&gt;
#&gt; $brahma
#&gt; # A tibble: 1 x 16
#&gt;      a1    a2    a3    a4    b1    b2    b3    b4    c1    c2    c3    c4    d1
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 -143.  5.29  23.0 -11.4 -13.9 -21.9  11.4  13.6  64.4 -3.15 -18.0  5.76 -485.
#&gt; # … with 3 more variables: d2 &lt;dbl&gt;, d3 &lt;dbl&gt;, d4 &lt;dbl&gt;
#&gt; ❯coe_single with 16 coefficients
#&gt; 
#&gt; $caney
#&gt; # A tibble: 1 x 16
#&gt;      a1    a2    a3    a4    b1    b2    b3    b4    c1    c2    c3    c4    d1
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 -134.  8.42  20.8 -2.59 -19.3 -30.3  8.69  4.37  57.0 -3.16 -15.7  5.58 -441.
#&gt; # … with 3 more variables: d2 &lt;dbl&gt;, d3 &lt;dbl&gt;, d4 &lt;dbl&gt;
#&gt; ❯coe_single with 16 coefficients
#&gt; </div><div class='output co'>#&gt; [1] "coo_list"      "list"          "vctrs_list_of" "vctrs_vctr"   
#&gt; [5] "list"         </div><div class='input'><span class='no'>bot</span>[<span class='fl'>1</span>:<span class='fl'>3</span>, ] <span class='kw'>%&gt;%</span> <span class='fu'>efourier</span>(<span class='fl'>4</span>) <span class='kw'>%&gt;%</span> <span class='fu'>efourier_norm</span>()</div><div class='output co'>#&gt; # A tibble: 3 x 3
#&gt;   type   fake  coe                   
#&gt;   &lt;fct&gt;  &lt;fct&gt; &lt;list&lt;coe_single[,0]&gt;&gt;
#&gt; 1 whisky a     &lt;tibble [1 × 16]&gt;     
#&gt; 2 whisky a     &lt;tibble [1 × 16]&gt;     
#&gt; 3 whisky a     &lt;tibble [1 × 16]&gt;     
#&gt; ❯mom_tbl</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.vincentbonhomme.fr'>Vincent Bonhomme</a>, Julien Claude.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


