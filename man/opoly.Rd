% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morpho_opoly.R
\name{opoly}
\alias{opoly}
\title{Orthogonal Polynomial Transform}
\usage{
opoly(x, degree = 5, raw = FALSE, ..., .cols = NULL, .name = "_coe")
}
\arguments{
\item{x}{A matrix (nx2), list of matrices, or tibble with coo columns.}

\item{degree}{Integer. Polynomial degree for the fit. Default is 5.}

\item{raw}{Logical. If \code{TRUE}, returns a list with coefficients and fit details
(only for single matrix). Default is \code{FALSE}.}

\item{...}{Additional arguments (reserved for future use).}

\item{.cols}{Column name(s) to process when \code{x} is a tibble. If \code{NULL},
processes all coo columns automatically.}

\item{.name}{Character. Name suffix for output coefficient columns when \code{x} is
a tibble. Default is \code{"_coe"}. Output columns will be named \code{originalname_coe}.
If a single custom name is provided and multiple columns are processed, an error
is raised.}
}
\value{
\itemize{
\item If \code{x} is a single matrix and \code{raw = FALSE}: returns a named numeric vector
with classes \code{c("opoly", "numeric")} containing degree+1 coefficients (x0, x1, ..., xN)
\item If \code{x} is a single matrix and \code{raw = TRUE}: returns a list with elements
\code{coeff}, \code{degree}, \code{baseline1}, \code{baseline2}, \code{r2}, \code{mod}
\item If \code{x} is a list: returns a list of coefficient vectors (each with class \code{c("opoly", "numeric")})
\item If \code{x} is a tibble: returns the tibble with new list-column(s) of class
\code{c("opoly", "coe", "list")} containing coefficient vectors
}
}
\description{
Compute orthogonal (Legendre) polynomial coefficients from open curve coordinates.
}
\details{
Orthogonal polynomial fitting uses Legendre polynomials to decompose open curves.
The method fits a polynomial model to the y-coordinates as a function of x-coordinates,
after baseline normalization.

Orthogonal polynomials are preferred over natural polynomials because adding a
higher degree does not change the lower-order coefficients. This makes them more
stable for comparative analysis.

The curve is automatically baseline-normalized using the first and last points
as landmarks, positioned at (-0.5, 0) and (0.5, 0) respectively.
\subsection{Choosing the polynomial degree}{

The default \code{degree = 5} works well for most open curves. Higher degrees capture
more detail but increase dimensionality. Use \code{raw = TRUE} to examine the R²
value and assess fit quality.
}
}
\examples{
# Single curve
data(olea)
cur <- olea$VD[[1]]
opoly_coefs <- opoly(cur)
opoly_coefs

# Get raw output with R² and model details
opoly(cur, raw = TRUE)

# With higher degree
opoly(cur, degree = 8)

# List of curves
cur_list <- list(cur, cur * 1.5, cur * 2)
opoly(cur_list)

\dontrun{
# Tibble - processes all coo columns by default
olea \%>\%
  opoly(degree = 6)  # Creates VD_coe and VL_coe

# Process specific column only
olea \%>\%
  opoly(.cols = VD)

# Custom name for single column
olea \%>\%
  opoly(.cols = VL, .name = "custom_name")
}

}
\seealso{
\code{\link[=opoly_i]{opoly_i()}} for inverse transform, \code{\link[=npoly]{npoly()}} for natural polynomials,
\code{\link[=dct]{dct()}} for discrete cosine transform.
}
