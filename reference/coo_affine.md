# Apply affine transformation

Apply an affine transformation (rotation, scaling, shearing, etc.) to a
shape using a 2x2 transformation matrix.

## Usage

``` r
coo_affine(x, ..., .cols = NULL, .ldk_col = NULL)
```

## Arguments

- x:

  A matrix (nx2), list of matrices, or tibble with coo columns.

- ...:

  Additional arguments (reserved for future use).

- .cols:

  Column name(s) to process when `x` is a tibble. If `NULL`,
  automatically detects columns containing coo objects.

- mat:

  A 2x2 numeric matrix defining the affine transformation.

## Value

- If `x` is a single matrix: returns the transformed matrix

- If `x` is a list: returns a list of transformed matrices

- If `x` is a tibble: returns the tibble with specified coo columns
  transformed

## Details

The transformation is applied as: `x_new = x %*% mat`

Common transformation matrices:

- Rotation by angle θ:
  `matrix(c(cos(θ), sin(θ), -sin(θ), cos(θ)), nrow = 2)`

- Scaling by sx, sy: `matrix(c(sx, 0, 0, sy), nrow = 2)`

- Shear in x: `matrix(c(1, 0, k, 1), nrow = 2)`

## See also

[`coo_rotate()`](https://momx.github.io/Momocs2/reference/coo_rotate.md)
for rotation;
[`coo_shear()`](https://momx.github.io/Momocs2/reference/coo_shear.md)
for shearing;
[`coo_flip()`](https://momx.github.io/Momocs2/reference/coo_flip.md) for
flipping

## Examples

``` r
# Rotation matrix
rot_mat <- matrix(c(cos(pi/4), sin(pi/4), -sin(pi/4), cos(pi/4)), nrow = 2)
coo_affine(shapes$cat, rot_mat)
#>            [,1]         [,2]
#>   [1,] 185.2620  -97.5807358
#>   [2,] 178.1909  -98.9949494
#>   [3,] 181.0193 -101.8233765
#>   [4,] 183.8478 -107.4802307
#>   [5,] 181.7264 -113.8441918
#>   [6,] 175.3625 -114.5512986
#>   [7,] 171.8269 -111.0157646
#>   [8,] 166.8772 -107.4802307
#>   [9,] 162.6346 -103.2375901
#>  [10,] 158.3919  -98.9949494
#>  [11,] 154.8564  -94.0452019
#>  [12,] 150.6137  -89.8025612
#>  [13,] 146.3711  -85.5599205
#>  [14,] 142.1285  -81.3172798
#>  [15,] 137.8858  -77.0746391
#>  [16,] 134.3503  -72.1248917
#>  [17,] 130.1076  -72.1248917
#>  [18,] 125.8650  -74.9533188
#>  [19,] 123.7437  -81.3172798
#>  [20,] 123.7437  -88.3883476
#>  [21,] 126.5721  -94.0452019
#>  [22,] 129.4005  -99.7020561
#>  [23,] 132.9361 -104.6518036
#>  [24,] 136.4716 -109.6015511
#>  [25,] 140.7142 -113.8441918
#>  [26,] 145.6640 -117.3797257
#>  [27,] 150.6137 -120.9152596
#>  [28,] 155.5635 -124.4507935
#>  [29,] 159.0990 -127.9863274
#>  [30,] 160.5132 -133.6431816
#>  [31,] 153.4422 -132.2289681
#>  [32,] 147.7853 -129.4005410
#>  [33,] 142.1285 -126.5721138
#>  [34,] 137.1787 -123.0365799
#>  [35,] 132.2290 -119.5010460
#>  [36,] 127.9863 -115.2584053
#>  [37,] 123.7437 -111.0157646
#>  [38,] 120.2082 -106.0660172
#>  [39,] 116.6726 -101.1162697
#>  [40,] 114.5513  -96.1665222
#>  [41,] 112.4300  -89.8025612
#>  [42,] 111.7229  -82.0243866
#>  [43,] 113.1371  -74.9533188
#>  [44,] 115.2584  -68.5893578
#>  [45,] 119.5010  -64.3467171
#>  [46,] 123.7437  -60.1040764
#>  [47,] 129.4005  -57.2756493
#>  [48,] 135.7645  -55.1543289
#>  [49,] 140.7142  -51.6187950
#>  [50,] 144.9569  -47.3761543
#>  [51,] 147.7853  -43.1335137
#>  [52,] 151.3209  -38.1837662
#>  [53,] 155.5635  -33.9411255
#>  [54,] 159.0990  -28.9913780
#>  [55,] 163.3417  -24.7487373
#>  [56,] 167.5843  -20.5060967
#>  [57,] 172.5341  -16.9705627
#>  [58,] 176.7767  -12.7279221
#>  [59,] 182.4335   -9.8994949
#>  [60,] 188.7975   -7.7781746
#>  [61,] 195.1615   -5.6568542
#>  [62,] 200.1112   -3.5355339
#>  [63,] 207.1823   -2.1213203
#>  [64,] 214.9605   -1.4142136
#>  [65,] 223.4457   -1.4142136
#>  [66,] 229.8097   -3.5355339
#>  [67,] 235.4666   -6.3639610
#>  [68,] 241.8305   -8.4852814
#>  [69,] 249.6087   -9.1923882
#>  [70,] 257.3869   -8.4852814
#>  [71,] 263.7508   -6.3639610
#>  [72,] 267.2864   -2.8284271
#>  [73,] 272.2361    0.7071068
#>  [74,] 277.8930    3.5355339
#>  [75,] 284.2569    5.6568542
#>  [76,] 292.0351    4.9497475
#>  [77,] 299.1062    3.5355339
#>  [78,] 305.4701    5.6568542
#>  [79,] 312.5412    7.0710678
#>  [80,] 319.6123    7.0710678
#>  [81,] 318.9052    0.7071068
#>  [82,] 315.3696   -4.2426407
#>  [83,] 311.8341   -7.7781746
#>  [84,] 310.4199  -12.0208153
#>  [85,] 312.5412  -18.3847763
#>  [86,] 313.2483  -24.7487373
#>  [87,] 313.2483  -31.8198052
#>  [88,] 313.9554  -38.1837662
#>  [89,] 309.0057  -41.7193001
#>  [90,] 301.9346  -43.1335137
#>  [91,] 294.1564  -42.4264069
#>  [92,] 288.4996  -43.8406204
#>  [93,] 284.2569  -48.0832611
#>  [94,] 281.4285  -52.3259018
#>  [95,] 277.8930  -57.2756493
#>  [96,] 273.6503  -61.5182900
#>  [97,] 269.4077  -65.7609307
#>  [98,] 265.1650  -70.0035713
#>  [99,] 259.5082  -72.8319985
#> [100,] 252.4371  -74.2462120
#> [101,] 245.3661  -75.6604256
#> [102,] 239.0021  -77.7817459
#> [103,] 233.3452  -80.6101731
#> [104,] 228.3955  -84.1457070
#> [105,] 224.8600  -87.6812409
#> [106,] 220.6173  -91.9238816
#> [107,] 216.3747  -96.1665222
#> [108,] 212.1320 -100.4091629
#> [109,] 207.8894 -104.6518036
#> [110,] 204.3539 -109.6015511
#> [111,] 202.2325 -114.5512986
#> [112,] 205.0610 -120.2081528
#> [113,] 202.9396 -125.1579003
#> [114,] 197.2828 -127.9863274
#> [115,] 190.2117 -126.5721138
#> [116,] 186.6762 -123.0365799
#> [117,] 183.8478 -117.3797257
#> [118,] 184.5549 -109.6015511
#> [119,] 185.9691 -102.5304833
#> [120,] 188.7975  -96.8736290
#> attr(,"class")
#> [1] "coo"    "matrix" "array" 

# Scaling matrix
scale_mat <- matrix(c(2, 0, 0, 2), nrow = 2)
coo_affine(shapes, scale_mat)
#> $cat
#>        [,1] [,2]
#>   [1,]  400  124
#>   [2,]  392  112
#>   [3,]  400  112
#>   [4,]  412  108
#>   [5,]  418   96
#>   [6,]  410   86
#>   [7,]  400   86
#>   [8,]  388   84
#>   [9,]  376   84
#>  [10,]  364   84
#>  [11,]  352   86
#>  [12,]  340   86
#>  [13,]  328   86
#>  [14,]  316   86
#>  [15,]  304   86
#>  [16,]  292   88
#>  [17,]  286   82
#>  [18,]  284   72
#>  [19,]  290   60
#>  [20,]  300   50
#>  [21,]  312   46
#>  [22,]  324   42
#>  [23,]  336   40
#>  [24,]  348   38
#>  [25,]  360   38
#>  [26,]  372   40
#>  [27,]  384   42
#>  [28,]  396   44
#>  [29,]  406   44
#>  [30,]  416   38
#>  [31,]  404   30
#>  [32,]  392   26
#>  [33,]  380   22
#>  [34,]  368   20
#>  [35,]  356   18
#>  [36,]  344   18
#>  [37,]  332   18
#>  [38,]  320   20
#>  [39,]  308   22
#>  [40,]  298   26
#>  [41,]  286   32
#>  [42,]  274   42
#>  [43,]  266   54
#>  [44,]  260   66
#>  [45,]  260   78
#>  [46,]  260   90
#>  [47,]  264  102
#>  [48,]  270  114
#>  [49,]  272  126
#>  [50,]  272  138
#>  [51,]  270  148
#>  [52,]  268  160
#>  [53,]  268  172
#>  [54,]  266  184
#>  [55,]  266  196
#>  [56,]  266  208
#>  [57,]  268  220
#>  [58,]  268  232
#>  [59,]  272  244
#>  [60,]  278  256
#>  [61,]  284  268
#>  [62,]  288  278
#>  [63,]  296  290
#>  [64,]  306  302
#>  [65,]  318  314
#>  [66,]  330  320
#>  [67,]  342  324
#>  [68,]  354  330
#>  [69,]  366  340
#>  [70,]  376  352
#>  [71,]  382  364
#>  [72,]  382  374
#>  [73,]  384  386
#>  [74,]  388  398
#>  [75,]  394  410
#>  [76,]  406  420
#>  [77,]  418  428
#>  [78,]  424  440
#>  [79,]  432  452
#>  [80,]  442  462
#>  [81,]  450  452
#>  [82,]  452  440
#>  [83,]  452  430
#>  [84,]  456  422
#>  [85,]  468  416
#>  [86,]  478  408
#>  [87,]  488  398
#>  [88,]  498  390
#>  [89,]  496  378
#>  [90,]  488  366
#>  [91,]  476  356
#>  [92,]  470  346
#>  [93,]  470  334
#>  [94,]  472  324
#>  [95,]  474  312
#>  [96,]  474  300
#>  [97,]  474  288
#>  [98,]  474  276
#>  [99,]  470  264
#> [100,]  462  252
#> [101,]  454  240
#> [102,]  448  228
#> [103,]  444  216
#> [104,]  442  204
#> [105,]  442  194
#> [106,]  442  182
#> [107,]  442  170
#> [108,]  442  158
#> [109,]  442  146
#> [110,]  444  134
#> [111,]  448  124
#> [112,]  460  120
#> [113,]  464  110
#> [114,]  460   98
#> [115,]  448   90
#> [116,]  438   90
#> [117,]  426   94
#> [118,]  416  106
#> [119,]  408  118
#> [120,]  404  130
#> 
#> $dog
#>        [,1] [,2]
#>   [1,]  400  212
#>   [2,]  388  210
#>   [3,]  374  212
#>   [4,]  362  212
#>   [5,]  348  214
#>   [6,]  336  216
#>   [7,]  324  214
#>   [8,]  312  200
#>   [9,]  304  188
#>  [10,]  290  174
#>  [11,]  278  166
#>  [12,]  266  156
#>  [13,]  254  142
#>  [14,]  248  130
#>  [15,]  244  118
#>  [16,]  252  104
#>  [17,]  256   94
#>  [18,]  242   90
#>  [19,]  230   90
#>  [20,]  220   98
#>  [21,]  218  112
#>  [22,]  218  124
#>  [23,]  218  138
#>  [24,]  218  150
#>  [25,]  224  162
#>  [26,]  238  176
#>  [27,]  248  188
#>  [28,]  252  202
#>  [29,]  246  192
#>  [30,]  234  180
#>  [31,]  220  170
#>  [32,]  208  164
#>  [33,]  214  178
#>  [34,]  224  190
#>  [35,]  226  202
#>  [36,]  230  216
#>  [37,]  230  228
#>  [38,]  232  240
#>  [39,]  230  254
#>  [40,]  232  266
#>  [41,]  234  280
#>  [42,]  240  292
#>  [43,]  248  304
#>  [44,]  262  318
#>  [45,]  274  324
#>  [46,]  288  328
#>  [47,]  300  330
#>  [48,]  312  330
#>  [49,]  326  332
#>  [50,]  338  332
#>  [51,]  352  332
#>  [52,]  364  332
#>  [53,]  376  332
#>  [54,]  390  330
#>  [55,]  402  330
#>  [56,]  416  332
#>  [57,]  428  332
#>  [58,]  440  336
#>  [59,]  454  340
#>  [60,]  466  348
#>  [61,]  476  358
#>  [62,]  486  372
#>  [63,]  494  384
#>  [64,]  502  398
#>  [65,]  506  410
#>  [66,]  512  422
#>  [67,]  516  436
#>  [68,]  528  448
#>  [69,]  542  454
#>  [70,]  554  454
#>  [71,]  566  454
#>  [72,]  580  444
#>  [73,]  590  432
#>  [74,]  604  428
#>  [75,]  616  428
#>  [76,]  628  428
#>  [77,]  632  414
#>  [78,]  632  402
#>  [79,]  630  388
#>  [80,]  620  380
#>  [81,]  608  376
#>  [82,]  594  376
#>  [83,]  582  372
#>  [84,]  578  358
#>  [85,]  572  346
#>  [86,]  568  334
#>  [87,]  562  320
#>  [88,]  558  308
#>  [89,]  554  296
#>  [90,]  554  282
#>  [91,]  550  270
#>  [92,]  548  256
#>  [93,]  546  244
#>  [94,]  540  232
#>  [95,]  534  218
#>  [96,]  532  206
#>  [97,]  532  192
#>  [98,]  532  180
#>  [99,]  532  168
#> [100,]  534  154
#> [101,]  534  142
#> [102,]  536  128
#> [103,]  548  120
#> [104,]  554  110
#> [105,]  540  102
#> [106,]  528  100
#> [107,]  518  110
#> [108,]  516  122
#> [109,]  514  134
#> [110,]  510  148
#> [111,]  504  160
#> [112,]  500  172
#> [113,]  494  186
#> [114,]  488  198
#> [115,]  476  208
#> [116,]  464  210
#> [117,]  452  210
#> [118,]  438  210
#> [119,]  426  212
#> [120,]  412  212
#> 
#> $heart
#>        [,1] [,2]
#>   [1,]  400   74
#>   [2,]  396   78
#>   [3,]  394   84
#>   [4,]  386   94
#>   [5,]  380  102
#>   [6,]  370  112
#>   [7,]  360  122
#>   [8,]  352  130
#>   [9,]  342  138
#>  [10,]  334  144
#>  [11,]  324  152
#>  [12,]  314  158
#>  [13,]  306  164
#>  [14,]  296  170
#>  [15,]  286  176
#>  [16,]  278  180
#>  [17,]  268  186
#>  [18,]  260  192
#>  [19,]  250  200
#>  [20,]  240  208
#>  [21,]  232  216
#>  [22,]  222  226
#>  [23,]  216  234
#>  [24,]  210  244
#>  [25,]  206  254
#>  [26,]  202  262
#>  [27,]  200  272
#>  [28,]  198  280
#>  [29,]  198  290
#>  [30,]  198  300
#>  [31,]  198  308
#>  [32,]  198  318
#>  [33,]  198  326
#>  [34,]  200  336
#>  [35,]  204  346
#>  [36,]  206  354
#>  [37,]  210  364
#>  [38,]  216  374
#>  [39,]  222  382
#>  [40,]  228  392
#>  [41,]  236  400
#>  [42,]  246  408
#>  [43,]  256  414
#>  [44,]  264  418
#>  [45,]  274  422
#>  [46,]  282  424
#>  [47,]  292  426
#>  [48,]  302  426
#>  [49,]  310  426
#>  [50,]  320  424
#>  [51,]  328  422
#>  [52,]  338  418
#>  [53,]  348  414
#>  [54,]  356  408
#>  [55,]  366  400
#>  [56,]  374  394
#>  [57,]  382  384
#>  [58,]  390  374
#>  [59,]  396  366
#>  [60,]  400  356
#>  [61,]  404  350
#>  [62,]  408  358
#>  [63,]  414  368
#>  [64,]  420  376
#>  [65,]  428  386
#>  [66,]  438  396
#>  [67,]  446  404
#>  [68,]  456  410
#>  [69,]  464  414
#>  [70,]  474  418
#>  [71,]  484  422
#>  [72,]  492  422
#>  [73,]  502  424
#>  [74,]  510  424
#>  [75,]  520  424
#>  [76,]  530  422
#>  [77,]  538  420
#>  [78,]  548  414
#>  [79,]  556  410
#>  [80,]  566  404
#>  [81,]  576  394
#>  [82,]  584  386
#>  [83,]  592  376
#>  [84,]  596  368
#>  [85,]  600  358
#>  [86,]  604  348
#>  [87,]  606  340
#>  [88,]  608  330
#>  [89,]  610  320
#>  [90,]  612  312
#>  [91,]  610  302
#>  [92,]  610  294
#>  [93,]  610  284
#>  [94,]  610  274
#>  [95,]  606  266
#>  [96,]  604  256
#>  [97,]  600  248
#>  [98,]  594  238
#>  [99,]  586  228
#> [100,]  578  220
#> [101,]  568  210
#> [102,]  560  204
#> [103,]  550  196
#> [104,]  540  188
#> [105,]  532  184
#> [106,]  522  178
#> [107,]  514  172
#> [108,]  504  166
#> [109,]  494  160
#> [110,]  486  154
#> [111,]  476  146
#> [112,]  466  138
#> [113,]  458  130
#> [114,]  448  122
#> [115,]  440  114
#> [116,]  430  104
#> [117,]  422   94
#> [118,]  416   86
#> [119,]  410   76
#> [120,]  406   68
#> 
#> $leaf2
#>        [,1] [,2]
#>   [1,]  400  124
#>   [2,]  400  110
#>   [3,]  398   98
#>   [4,]  394   84
#>   [5,]  392   72
#>   [6,]  388   58
#>   [7,]  380   44
#>   [8,]  368   40
#>   [9,]  358   48
#>  [10,]  366   60
#>  [11,]  374   74
#>  [12,]  378   88
#>  [13,]  380  100
#>  [14,]  382  114
#>  [15,]  384  126
#>  [16,]  384  140
#>  [17,]  372  136
#>  [18,]  358  132
#>  [19,]  344  130
#>  [20,]  332  130
#>  [21,]  318  132
#>  [22,]  306  132
#>  [23,]  292  136
#>  [24,]  278  140
#>  [25,]  266  144
#>  [26,]  252  150
#>  [27,]  254  160
#>  [28,]  266  174
#>  [29,]  280  188
#>  [30,]  284  198
#>  [31,]  270  206
#>  [32,]  258  214
#>  [33,]  244  224
#>  [34,]  230  238
#>  [35,]  232  248
#>  [36,]  246  254
#>  [37,]  254  258
#>  [38,]  244  272
#>  [39,]  234  284
#>  [40,]  226  298
#>  [41,]  218  312
#>  [42,]  218  324
#>  [43,]  232  324
#>  [44,]  244  322
#>  [45,]  258  320
#>  [46,]  266  322
#>  [47,]  268  334
#>  [48,]  278  342
#>  [49,]  290  336
#>  [50,]  304  326
#>  [51,]  318  316
#>  [52,]  330  304
#>  [53,]  332  306
#>  [54,]  328  318
#>  [55,]  324  332
#>  [56,]  320  346
#>  [57,]  318  358
#>  [58,]  318  372
#>  [59,]  322  384
#>  [60,]  336  382
#>  [61,]  348  378
#>  [62,]  362  374
#>  [63,]  362  388
#>  [64,]  364  400
#>  [65,]  368  414
#>  [66,]  372  426
#>  [67,]  380  440
#>  [68,]  392  452
#>  [69,]  404  442
#>  [70,]  412  428
#>  [71,]  416  416
#>  [72,]  420  402
#>  [73,]  420  388
#>  [74,]  422  376
#>  [75,]  434  378
#>  [76,]  446  382
#>  [77,]  460  384
#>  [78,]  466  372
#>  [79,]  466  360
#>  [80,]  464  346
#>  [81,]  462  334
#>  [82,]  458  320
#>  [83,]  452  306
#>  [84,]  452  302
#>  [85,]  466  316
#>  [86,]  478  326
#>  [87,]  492  336
#>  [88,]  504  342
#>  [89,]  516  336
#>  [90,]  518  322
#>  [91,]  524  318
#>  [92,]  538  322
#>  [93,]  550  324
#>  [94,]  564  324
#>  [95,]  564  312
#>  [96,]  560  300
#>  [97,]  550  286
#>  [98,]  542  274
#>  [99,]  532  260
#> [100,]  538  254
#> [101,]  550  250
#> [102,]  552  238
#> [103,]  542  226
#> [104,]  528  214
#> [105,]  514  206
#> [106,]  502  198
#> [107,]  504  188
#> [108,]  516  176
#> [109,]  528  162
#> [110,]  534  150
#> [111,]  520  144
#> [112,]  506  140
#> [113,]  494  136
#> [114,]  480  132
#> [115,]  468  132
#> [116,]  454  130
#> [117,]  440  130
#> [118,]  428  132
#> [119,]  414  136
#> [120,]  402  138
#> 
#> attr(,"class")
#> [1] "coo"  "list"
```
