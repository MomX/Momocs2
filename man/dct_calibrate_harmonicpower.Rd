% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morpho_calibrate.R
\name{dct_calibrate_harmonicpower}
\alias{dct_calibrate_harmonicpower}
\title{Calibrate number of harmonics using harmonic power}
\usage{
dct_calibrate_harmonicpower(
  x,
  nb_h = 20,
  id = NULL,
  thresh = c(90, 95, 99),
  .cols = NULL
)
}
\arguments{
\item{x}{A tibble with coo columns containing open curves.}

\item{nb_h}{Integer. Maximum number of harmonics to compute. Default is 20.}

\item{id}{Integer vector or NULL. Which shapes to use for calibration.
If NULL, uses all shapes (or samples if many). If integer vector, uses
those specific row indices.}

\item{thresh}{Numeric vector. Cumulative power thresholds (percentage) for
recommendations. Default is c(90, 95, 99).}

\item{.cols}{Column name(s) to process. If NULL, uses first coo column.
Supports tidyeval (e.g., \code{.cols = VD}).}
}
\value{
A list with class \code{c("calibrate_harmonicpower", "calibrate")} containing:
\itemize{
\item \code{data}: Tibble with columns shape, harmonic, and power
\item \code{recommended}: Named integer vector of minimum harmonics per threshold
\item \code{summary}: Character string with human-readable recommendation
}

The list has attributes:
\itemize{
\item \code{method}: "dct"
\item \code{metric}: "harmonicpower"
\item \code{param_name}: "harmonic"
\item \code{thresh}: the threshold values used
}
}
\description{
Calculate cumulative harmonic power across a range of harmonics to
determine optimal number for discrete cosine transform.
}
\details{
Harmonic power measures how much shape variation each harmonic captures.
Cumulative power reaches 100\% asymptotically. The goal is to find the
minimum number of harmonics that captures sufficient variation (e.g., 99\%).
\subsection{Choosing thresholds}{

Common interpretations:
\itemize{
\item 90\%: Captures major shape features
\item 95\%: Good balance for most applications
\item 99\%: High fidelity, captures fine details
}
}

\subsection{Sampling strategy}{

When \code{id = NULL}:
\itemize{
\item If <= 30 shapes: uses all
\item If > 30 shapes: randomly samples 30
}
}

\subsection{Plotting}{

Use \code{plot(cal)} to visualize results as cumulative power curves.
}
}
\examples{
# Calibrate on subset of olea
data(olea)
cal <- olea[1:10, ] \%>\%
  dct_calibrate_harmonicpower(.cols=VD)

cal$recommended
cal$summary
plot(cal)

# Use recommended harmonics
olea \%>\% dct(nb_h = cal$recommended["99"])

}
\seealso{
\code{\link[=dct_calibrate_reconstruction]{dct_calibrate_reconstruction()}}, \code{\link[=dct]{dct()}}
}
