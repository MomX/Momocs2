% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morpho_efourier.R
\name{efourier}
\alias{efourier}
\title{Elliptic Fourier Transform}
\usage{
efourier(x, nb_h = 6, raw = FALSE, ..., .cols = NULL, .name = "coe")
}
\arguments{
\item{x}{A matrix (nx2), list of matrices, or tibble with coo columns.}

\item{nb_h}{Integer. Number of harmonics to compute. Default is 6.}

\item{raw}{Logical. If \code{TRUE}, returns a list with a0, c0 and harmonic
coefficients (only for single matrix). Default is \code{FALSE}.}

\item{...}{Additional arguments (reserved for future use).}

\item{.cols}{Column name(s) to process when \code{x} is a tibble. If \code{NULL},
automatically detects columns containing coo objects. If multiple coo
columns exist, must be specified explicitly.}

\item{.name}{Character. Name for the output coefficient column when \code{x} is
a tibble. Default is \code{"coe"}. If this column already exists, an error is raised.}
}
\value{
\itemize{
\item If \code{x} is a single matrix and \code{raw = FALSE}: returns a named numeric vector
with classes \code{c("eft", "numeric")} containing 4*nb_h coefficients (An, Bn, Cn, Dn)
\item If \code{x} is a single matrix and \code{raw = TRUE}: returns a list with elements
\code{an}, \code{bn}, \code{cn}, \code{dn}, \code{a0}, \code{c0}
\item If \code{x} is a list: returns a list of coefficient vectors (each with class \code{c("eft", "numeric")})
\item If \code{x} is a tibble: returns the tibble with a new list-column of class
\code{c("eft", "coe", "list")} containing coefficient vectors
}
}
\description{
Compute elliptic Fourier transform coefficients from outline coordinates.
}
\details{
Elliptic Fourier analysis decomposes a closed outline into a sum of harmonically
related ellipses. The method is based on separate Fourier decompositions of the
incremental changes in x and y coordinates as a function of cumulative perimeter
distance.

For each harmonic n, four coefficients are computed:
\itemize{
\item An, Bn: coefficients for x-coordinates (cosine and sine terms)
\item Cn, Dn: coefficients for y-coordinates (cosine and sine terms)
}

The \code{raw = TRUE} option additionally returns \code{a0} and \code{c0} (the constant terms),
which represent the centroid position. This is only available for single matrices.
\subsection{Choosing the number of harmonics}{

The default \code{nb_h = 6} works well for most outlines. More harmonics capture finer
details but increase dimensionality. Use fewer harmonics for simpler shapes or
to reduce noise. As a rule of thumb, nb_h should be less than the number of
outline points divided by 3.
}
}
\examples{
# Single outline
coo <- matrix(runif(100), ncol = 2)
eft_coefs <- efourier(coo)
eft_coefs

# Get raw output with a0 and c0
efourier(coo, raw = TRUE)

# With more harmonics
efourier(coo, nb_h = 10)

# List of outlines
coo_list <- list(coo, coo * 1.5, coo * 2)
efourier(coo_list)

\dontrun{
# Tibble (requires coo column)
library(dplyr)
bot \%>\%
  efourier(nb_h = 8)

# Specify column explicitly
bot \%>\%
  efourier(.cols = coo, .name = "eft_coefs")
}

}
\seealso{
\code{\link[=efourier_i]{efourier_i()}} for inverse transform, \code{\link[=efourier_norm]{efourier_norm()}} for numeric normalisation.
}
